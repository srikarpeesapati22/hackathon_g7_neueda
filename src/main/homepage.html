<!DOCTYPE html>
<html>
<head>
  <title>Stock API Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4CAF50;
      color: white;
      padding: 10px 0;
      text-align: center;
    }
    .container {
      width: 80%;
      margin: auto;
      overflow: hidden;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #45a049;
    }
    input[type=text] {
      width: 200px;
      padding: 10px;
      margin-top: 10px;
    }
    #stock-list, #stock-detail {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #stock-list li, #stock-detail {
      background-color: white;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ddd;
    }
    #chartContainer {
      margin-top: 20px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    async function fetchStocks() {
      const response = await fetch('/api/stocks');
      const stocks = await response.json();
      const stockList = document.getElementById('stock-list');
      stockList.innerHTML = '';

      stocks.forEach(stock => {
        const listItem = document.createElement('li');
        listItem.textContent = `${stock.name}: $${stock.price.toFixed(2)}`;
        stockList.appendChild(listItem);
      });

      // Generate chart data
      const labels = stocks.map(stock => stock.name);
      const data = stocks.map(stock => stock.price);
      renderChart(labels, data);
    }

    async function fetchStockByName() {
      const name = document.getElementById('stock-name').value;
      const response = await fetch(`/api/stocks/${name}`);
      const stock = await response.json();
      const stockDetail = document.getElementById('stock-detail');
      stockDetail.innerHTML = '';

      if (stock) {
        stockDetail.textContent = `${stock.name}: $${stock.price.toFixed(2)}`;
      } else {
        stockDetail.textContent = 'Stock not found';
      }
    }

    function renderChart(labels, data) {
      const ctx = document.getElementById('stockChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Stock Prices',
            data: data,
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }
  </script>
</head>
<body>
<header>
  <h1>Stock API Demo</h1>
</header>
<div class="container">
  <button onclick="fetchStocks()">Fetch All Stocks</button>
  <ul id="stock-list"></ul>
  <br>
  <input type="text" id="stock-name" placeholder="Enter stock name">
  <button onclick="fetchStockByName()">Fetch Stock</button>
  <div id="stock-detail"></div>
  <div id="chartContainer">
    <canvas id="stockChart" width="400" height="200"></canvas>
  </div>
</div>
</body>

</html>
